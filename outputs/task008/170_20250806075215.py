e=enumerate;f=lambda g:[*map(list,zip(*(g,g[(a:=max(i for i,v in e(g)if 2in v)+1):(b:=min(i for i,v in e(g)if 8in v))]+g[:a]+g[b:])[a<b]))][::-1];p=lambda g:f(f(f(f(g))))