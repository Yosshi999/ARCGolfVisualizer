p=lambda g,d=4:p([*zip(*(g,sorted(g[:(a:=g.index(max(g,key=max)))],key=max)+g[a:])[{*g[a]}=={0,8}])][::-1],d-1)if d else g