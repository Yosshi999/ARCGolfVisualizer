p=lambda g,n=20:n and[(d:=0)or[d:=c and(c-(d>0),c-(c*d==9),c*(d<1)+min(d,c),c-1)[n//20+(n>8)+(n>4)]for c in v]for*v,in zip(*p(g,n-1)[::-1])]or g