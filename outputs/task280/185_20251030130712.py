e=enumerate
p=lambda g,d=4:d and p([max([v]+[((k!=i)+2,)*l+v[l:]for k,u in e(zip(*g))if 2in u!=1>u[(l:=u.index(2))-1]<[*u[l:],0].index(0)>abs(k-i)])for i,v in e(zip(*g))][::-1],d-1)or g