p=lambda g:max([[(u:=[a for*w,a in zip(*g,v)if c in w])*(u==u[::-1])for v in g if c in v]for c in sum(g,[])],key=all)