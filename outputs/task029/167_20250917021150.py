def p(g):
 C=min(c for c in sum(g,[])if len(l:={v.count(c)for v in g}-{0,2})==1<max(l))
 return[[c for w,c in zip(zip(*g),v)if C in w][1:-1]for v in g if C in v][1:-1]