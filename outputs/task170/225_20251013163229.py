def p(g):I=g.index(u:=max(g[::-1],key=any));J=u.index(max(u,key=bool));s=3+(u[J+3]>0);q=[*eval('zip(*filter(max,'*2+'g[:I-s+1]))))')];d=-~len(q)//s;return[[a*(b>0)for a,b in zip(v[J:],w[::d])]for v,w in zip(g[I-s+1:],q[::d])]