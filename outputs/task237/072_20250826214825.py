p=lambda g,b=0:[-~(c:=0)*[c:=w or c for w in v]+[b:=c or b]for*v,t in g]