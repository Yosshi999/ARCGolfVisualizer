p=lambda g:[[*map(max,*[v for v in g+[*zip(*g)]if any(x==y>0for x,y in zip(v,u))])]for u in g]