e=enumerate
p=lambda g:[g:=[[x-x//8*2*(2>w[i-2]*v[j-2]in w[i:]or 6in v+w)for j,(*w,x)in e(zip(*g,v))]for i,v in e(g)]for _ in g][1]