f=lambda g:[[max(v[j%(d:=(l:=len(v)-v.count(0),99)[l<2])::d])for j in range(len(v))]for v in zip(*g)]
p=lambda g:f(f(g))