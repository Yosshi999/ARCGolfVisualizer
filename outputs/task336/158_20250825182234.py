f=lambda g:[*zip(*[[a or 8*((5in v)*(5in w)or (i>4and 5in w and 5 not in w[4:]))for*w,a in zip(*g,v)]for i,v in enumerate(g)])][::-1]
p=lambda g:f(f(f(f(g))))