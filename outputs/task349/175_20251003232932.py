e=enumerate
def p(g):return[[x or any(-(l:=(m:=W//9*-~m)//2)<=i-I<l+1>j-J>-l*3for I,V in e(g)if(m:=1)for J,W in e(V))*3or 9in w[:i]for j,(*w,x)in e(zip(*g,v))]for i,v in e(g)]