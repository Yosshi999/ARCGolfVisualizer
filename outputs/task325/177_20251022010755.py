p=lambda g,n=24,i=0:n and p([(d:=0)or[d:=(c<<(i:=i+1),c|d*(c>0))[n<24]for c in v]for*v,in zip(*g)][::-1],n-1)or(r:=range(len({*sum(g,[])})-1))and[[8*(i==j)for j in r]for i in r]