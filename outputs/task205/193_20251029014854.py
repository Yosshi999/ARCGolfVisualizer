def p(g,d=0):C,*_,c=sorted(v:=sum(g,[]),key=v.count);return d<1.1and p([v for*v,in zip(*g)if v.count(c)>max(v.count(c)for v in zip(*g))*d-2],d+.1)or[[(c,C)[C in v+w]for*w,in zip(*g)]for v in g]