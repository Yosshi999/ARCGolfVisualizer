e=enumerate;p=lambda g:[[w or i*j%max(sum(g,[]))+1for j,w in e(v)]for i,v in e(g)]