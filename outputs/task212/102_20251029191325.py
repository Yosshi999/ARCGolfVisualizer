p=lambda g:exec('m=g[f:=0];g[::-1]=[m:=[c|d*(d==2-(f:=f|c)//4)for c,d in zip(v,m)]for v in g];'*2)or g