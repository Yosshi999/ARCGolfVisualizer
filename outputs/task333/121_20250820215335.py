def p(g):exec('g[:]=[[(w,m:=max(v[:j+1]))[m>w<(3in v[j+1:])]for j,w in enumerate(v)]for v in zip(*g)][::-1];'*4);return g