p=lambda g,d=4:p([[(w,m:=max(v[:j+1]))[m>w<(3in v[j+1:])]for j,w in enumerate(v)]for v in zip(*g)][::-1],d-1)if d else g