E=enumerate
def p(g):
 G=sum(g,[]);L=sorted({*G},key=G.count)
 for k in L:
  if any(min(H:={x-99*(len(g)>(I:=i-Z//46+32>>1)>-1<(J:=j-Z%46+32>>1)<len(v)>0<g[I][J]==k)for i,v in E(g)for j,x in E(v)})<0<len({*H})<5for Z in range(2116)):return[[(L[-1],k)[x==k]for*w,x in zip(*g,v)if k in w]for v in g if k in v]