E=enumerate
R=range(-32,14)
def p(g):
 G=sum(g,[])
 L=sorted({*G},key=G.count)
 for k in L:
  if any(min(H:={x-99*(len(g)>i-Y>>1>-1<j-X>>1<len(v)>0<g[i-Y>>1][j-X>>1]==k)for i,v in E(g)for j,x in E(v)})<0<len({*H})<5for Y in R for X in R):return[[(L[-1],k)[x==k]for*w,x in zip(*g,v)if k in w]for v in g if k in v]