p=lambda g:[g:=[(y:=0)or[y:=x or sum({*y%8*sum(g,[-8-y])})for x in v]for*v,in zip(*g)][::-1]for _ in g*16][-1]