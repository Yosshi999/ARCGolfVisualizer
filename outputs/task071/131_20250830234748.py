p=lambda g:[[(m:=max(v:=next(filter(max,g))))*(m in[w]+u[v.index(m)+15-v[::-1].index(m)-j:][:1])for j,w in enumerate(u)]for u in g]