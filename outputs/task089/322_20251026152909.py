r=range(13)
def p(g):F=[[(i,j)for i in r for j in r if g[i][j]==C]for C in r];D=dict(sum([min((max(abs(y-Y),abs(x-X)),[((B-y+b,(x-A)*(-1)**P+a),c)for(B,A)in F[c]for(b,a)in{*F[P]}-{(y,x)}])for(Y,X)in F[c]for P in[2,3]for(y,x)in F[P])[1]for c in r if(c==1or c>3)*F[c]],[]));return[[D.get((i,j),g[i][j])for j in r]for i in r]