f=lambda g:[[max((v[i],k*11)[k in{*v[:i]}&{*v[i:]}]for k in v)%10for v in g]for i in range(len(g[0]))];p=lambda g:f(f(g))